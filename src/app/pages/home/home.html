<div class="container mt-5">
  <div class="row d-flex justify-content-between align-items-center">
    <div class="col-3">
      <span class="row m-1">Buscar por numero de coche</span>
      <input
        class="form-control col ms-0"
        maxlength="5"
        type="text"
        [formControl]="codeSearch"
      />
    </div>
    <button
      class="btn btn-info col-2 h-50 text-white"
      data-bs-toggle="modal"
      data-bs-target="#createArrivalModal"
    >
      + Crear ingreso
    </button>
  </div>
</div>

<app-generic-modal-form
  [formFields]="formFields"
  [onSubmit]="onSubmit"
  targetId="createArrivalModal"
  title="Ingresar nuevo coche"
></app-generic-modal-form>

<div class="container mt-5">
  <table class="table table-striped table-hover text-center">
    <thead>
      <tr>
        <th scope="col">Fecha</th>
        <th scope="col">Nro Coche</th>
        <th scope="col">Horario ingreso</th>
        <th scope="col">Observaciones</th>
        <th scope="col">Limpiado por</th>
        <th scope="col">Estado</th>
        <th scope="col">Eliminar</th>
      </tr>
    </thead>
    <tbody>
      @for (arrival of (filtredArrivals | slice:
      currentPage*pageSize:currentPage*pageSize+pageSize); track arrival.id){
      <tr>
        <td>{{arrival['date'] | date: 'dd/MM'}}</td>
        <th>{{arrival['code']}}</th>
        <td>{{arrival['date'] | date: 'hh:mm'}}</td>
        <td>{{arrival['observations']}}</td>
        <td>
          <select
            class="btn btn-danger dropdown-toggle w-50"
            [ngModel]="arrival.cleaner?.id"
            (ngModelChange)="onChangeCleaner(arrival.id, $event)"
          >
            <option [value]="''" disabled *ngIf="!arrival.cleaner">
              Seleccionar
            </option>
            <option *ngFor="let crew of crews" [value]="crew.id">
              {{ crew.name }}
            </option>
          </select>
        </td>
        <td>{{getStateString(arrival['state'])}}</td>
        <td>
          <a appCursorPointer (click)="onRemove(arrival.id)">
            <fa-icon [icon]="removeIcon" class="text-black"></fa-icon>
          </a>
        </td>
      </tr>
      }
    </tbody>
  </table>
</div>

<div class="container d-flex justify-content-center mt-5">
  <nav aria-label="Page navigation example">
    <ul class="pagination">
      <li class="page-item" appCursorPointer>
        <a class="page-link" (click)="onChangePage(currentPage -1)">Anterior</a>
      </li>
      <li
        class="page-item"
        appCursorPointer
        [ngClass]="{'active': currentPage === page -1}"
        *ngFor="let page of arrivalsPages"
      >
        <a class="page-link" (click)="onChangePage(page - 1)">{{page}}</a>
      </li>
      <li class="page-item" appCursorPointer>
        <a class="page-link" (click)="onChangePage(currentPage +1)"
          >Siguietne</a
        >
      </li>
    </ul>
  </nav>
</div>
